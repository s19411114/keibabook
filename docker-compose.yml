version: '3.8'

services:
  app:
    build: .
    container_name: keibabook-dev
    volumes:
      # ホストのプロジェクトディレクトリをマウント（デフォルト: 現在のディレクトリ）
      # 開発中に高速な I/O を利用するには WSL のホームのパスを指定してください。
      # 例: HOST_PROJECT_DIR=/home/<user>/keibabook docker-compose up
      - ${HOST_PROJECT_DIR:-.}:/app
      # venvは除外 (Dockerは独自のPython環境を使用)
      - /app/venv
      # __pycache__も除外
      - /app/__pycache__
    ports:
      # Streamlit用ポート
      - "8501:8501"
      # 追加のポート (必要に応じて)
      - "8502:8502"
    environment:
      # Python出力をバッファリングしない (ログがリアルタイムで表示される)
      - PYTHONUNBUFFERED=1
      # Playwrightの設定
      - PLAYWRIGHT_BROWSERS_PATH=/ms-playwright
      # ログイン情報（開発用）: コンテナへ環境変数で安全に渡してください
      - LOGIN_ID=${LOGIN_ID:-}
      - LOGIN_PASSWORD=${LOGIN_PASSWORD:-}
    stdin_open: true
    tty: true
    # コンテナ起動時にbashを実行
    command: bash
