# 作業記録・ロールバックガイド

## 目的
トークン上限を避けるため、同じ間違いを繰り返さないワークフローを確立します。

## ワークフロー

### 1. 作業前のチェックポイント作成

重要な変更を始める前に、必ず現在の状態を保存：

**VSCodeのソース管理ビュー（Ctrl+Shift+G）で:**
1. 変更されたファイルを確認
2. すべてステージング（`+`ボタン）
3. コミットメッセージを入力（例: `checkpoint: ログイン機能完成`）
4. コミット

### 2. Antigravity拡張機能での編集

**効率的な編集方法:**
1. 改善したいコード部分を選択
2. 右クリック → "Ask Gemini to edit"
3. 具体的な指示を出す（例: 「この関数をエラーハンドリング追加して」）

### 3. 変更の確認

編集後、必ず動作確認：
- テストを実行
- 期待通りに動作するか確認

### 4. 問題があった場合のロールバック

**VSCodeのソース管理ビューで:**
1. タイムラインビューを開く（ファイルエクスプローラーの下部）
2. または、ソース管理ビューで "..." → "View History"
3. 戻りたいコミットを右クリック
4. "Reset Current Branch to Commit..." を選択
5. "Hard" を選択（すべての変更を破棄）

### 5. 問題なければコミット

動作確認OKなら、すぐにコミット：
```
コミットメッセージ例:
- "fix: ログイン時のエラーハンドリング追加"
- "feat: 会場マネージャーに地方競馬対応追加"
- "refactor: データベース接続処理を改善"
```

## ベストプラクティス

### ✅ やるべきこと
- **小さく頻繁にコミット**: 1つの機能ごとにコミット
- **明確なコミットメッセージ**: 何を変更したか一目でわかるように
- **変更前にチェックポイント**: 大きな変更の前は必ず保存
- **動作確認してからコミット**: 壊れた状態をコミットしない

### ❌ 避けるべきこと
- **複数の機能を1つのコミットに**: ロールバックが難しくなる
- **テストせずにコミット**: 後で問題が見つかると戻すのが大変
- **曖昧なコミットメッセージ**: "update" "fix" だけでは何を変更したか不明

## トラブルシューティング

### Q: 間違った変更をコミットしてしまった
A: `git reset --hard HEAD~1` で直前のコミットを取り消し

### Q: stashした内容を復元したい
A: `git stash list` で確認 → `git stash apply stash@{0}` で復元

### Q: 特定のファイルだけ元に戻したい
A: ファイルを右クリック → "Discard Changes"

## 現在の状態復元

現在、stashに保存された「ほぼ完成に近かった状態」があります：
```bash
git stash apply stash@{0}
```

これで復元できます。
